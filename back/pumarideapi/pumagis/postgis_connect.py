""" Raw queries to postgis """

import psycopg2

db = "pumaride"
usr = "pumaride"
password = "puma_ride123."

def query(c):
    """ Be wary of SQL injection, nothing here is stopping it"""
    c.execute('SELECT name FROM table')
    return c.fetchall()

def connect():
    conn = psycopg2.connect(database=db, user=usr, host='localhost', password=password)
    c = conn.cursor()
    return (conn, c)

def agregar_ruta(c, id, PuntosTexto, Capa):
    """ Be wary of SQL injection, nothing here is stopping it"""
    query = "insert into ruta values(%s, ST_GeomFromText('LINESTRING(%s)',4326), %s)" % (id, PuntosTexto, Capa)
    c.execute(query)

# create table ruta (id_ruta integer primary key, puntos geography(LINESTRING,4326), modo integer);
# 
# create table horario_ruta (id_ruta integer references ruta(id_ruta), origen geography(POINT,4326), destino geography(POINT,4326), origen_hora timestamp, destino_hora timestamp);
# 
# ------------------ INSERTS ------------------
# 
""" insert into ruta values (1,ST_GeomFromText('LINESTRING(-99.1740833701 19.4099815771,-99.173744 19.410692,-99.173051 19.410357,-99.172879 19.410291,-99.172459 19.408575,-99.172249 19.407865,-99.172141 19.407371,-99.17188 19.406362,-99.171758 19.405788,-99.171378 19.40432,-99.171215 19.403536,-99.170856 19.402317,-99.170756 19.401949,-99.170427 19.400758,-99.170367 19.400507,-99.17025 19.400105,-99.170134 19.399697,-99.170422 19.399652,-99.170895 19.398399,-99.17129 19.397266,-99.17144 19.396841,-99.171629 19.396107,-99.1723 19.394076,-99.172671 19.392766,-99.172933 19.391969,-99.173054 19.391598,-99.173187 19.391205,-99.17336 19.390621,-99.173529 19.390168,-99.173702 19.389663,-99.17382 19.389293,-99.173919 19.388942,-99.174103 19.38843,-99.174214 19.388143,-99.174908 19.38609,-99.175023 19.385645,-99.175196 19.385152,-99.17549 19.384392,-99.175907 19.383229,-99.176156 19.382384,-99.176353 19.381807,-99.176547 19.381217,-99.176737 19.380631,-99.176907 19.380086,-99.177275 19.378831,-99.17758 19.377934,-99.177919 19.376941,-99.178031 19.37661,-99.17838 19.37567,-99.178527 19.375143,-99.178978 19.373678,-99.179634 19.371586,-99.180112 19.370154,-99.180446 19.369099,-99.180924 19.36782,-99.18133 19.366414,-99.181485 19.365821,-99.181819 19.364867,-99.181986 19.364274,-99.182464 19.362716,-99.182782 19.362315,-99.182797 19.362135,-99.182911 19.361317,-99.183351 19.360143,-99.183805 19.35892,-99.184232 19.357428,-99.184718 19.356,-99.185181 19.354546,-99.185506 19.353475,-99.185629 19.35313,-99.185825 19.352291,-99.186104 19.351437,-99.186506 19.350316,-99.186779 19.34938,-99.187413 19.347381,-99.188239 19.345435,-99.188531 19.344515,-99.18863 19.344154,-99.189173 19.343663,-99.189671 19.34348,-99.190666 19.343175,-99.190806 19.342673,-99.190916 19.342353,-99.191655 19.339852,-99.191938 19.33874,-99.192449 19.337945,-99.193024 19.337186,-99.193046 19.33654,-99.192884 19.335361,-99.192523 19.334922,-99.191818 19.334823,-99.191449 19.334784,-99.191173 19.334824,-99.19118 19.333877,-99.192371 19.334082,-99.194341 19.333674,-99.194442 19.333626,-99.194609 19.333539,-99.194911 19.33337)',4326),1);"""
